USE ft_tmp;
CREATE TABLE IF NOT EXISTS useful_features_from_bz(
user_id                               STRING   COMMENT    '用户pin',
user_ord_until_now                    DOUBLE   COMMENT    '客户最近订单距今天数',
sale_ord_cnt_last_12                  DOUBLE   COMMENT    '客户近12个月总订单数',
sku_cnt_last_12                       DOUBLE   COMMENT    '客户近12个月购买商品总数量',
actu_pay_amt_last_12                  DOUBLE   COMMENT    '客户近12个月实付总金额',
sale_amt_avg_curr                     DOUBLE   COMMENT    '客户当月平均单笔订单金额',
sale_amt_avg_last_3                   DOUBLE   COMMENT    '客户近3个月平均单笔订单金额',
sale_amt_avg_last_6                   DOUBLE   COMMENT    '客户近6个月平均单笔订单金额',
sale_amt_avg_last_12                  DOUBLE   COMMENT    '客户近12个月平均单笔订单金额',
sale_amt_per_ord_max_last_12          DOUBLE   COMMENT    '客户近12个月单笔订单最大金额',
xiaofeiyuefei                         DOUBLE   COMMENT    '近12个月有消费月份数',
dingdanshu                            DOUBLE   COMMENT    '近12个月消费订单数',
shifujine                             DOUBLE   COMMENT    '近12个月消费实付金额',
danbizuida                            DOUBLE   COMMENT    '近12个月单笔最大消费',
sale_amt_per_ord_min_last_12          DOUBLE   COMMENT    '客户近12个月单笔订单最小金额',
amt_actual_payment                    DOUBLE   COMMENT    '实际付款金额',
amt_pay_order                         DOUBLE   COMMENT    '先款订单金额',
amt_daofu_order                       DOUBLE   COMMENT    '到付订单金额',
amt_on_line_order                     DOUBLE   COMMENT    '在线支付订单金额',
amt_total_offer                       DOUBLE   COMMENT    '总优惠金额',
amt_full_minus_offer                  DOUBLE   COMMENT    '满减优惠金额',
amt_dq_and_jq_pay                     DOUBLE   COMMENT    '东券/京券支付金额',
amt_gift_cps_pay                      DOUBLE   COMMENT    '礼品卡支付金额',
amt_rebate                            DOUBLE   COMMENT    '返现金额',
amt_ziti_order                        DOUBLE   COMMENT    '自提订单金额',
amt_lock_order                        DOUBLE   COMMENT    '锁定订单金额',
amt_pause_order                       DOUBLE   COMMENT    '暂停订单金额',
amt_object_order                      DOUBLE   COMMENT    '实物订单金额',
amt_virtual_order                     DOUBLE   COMMENT    '虚拟订单金额',
amt_game_order                        DOUBLE   COMMENT    '游戏订单金额',
amt_lottery_order                     DOUBLE   COMMENT    '彩票订单定额',
amt_order_book                        DOUBLE   COMMENT    '图书音像类商品消费金额',
amt_order_car                         DOUBLE   COMMENT    '汽车用品消费金额',
amt_order_digi                        DOUBLE   COMMENT    '电子商品消费金额',
amt_order_elec                        DOUBLE   COMMENT    '家用电器消费金额',
amt_order_fashion                     DOUBLE   COMMENT    '时尚类商品消费金额',
amt_order_food                        DOUBLE   COMMENT    '生鲜食品类消费金额',
amt_order_gift                        DOUBLE   COMMENT    '礼品类商品消费金额',
amt_order_home                        DOUBLE   COMMENT    '家居用品消费金额',
amt_order_jewelry                     DOUBLE   COMMENT    '珠宝首饰消费金额',
amt_order_med                         DOUBLE   COMMENT    '医药器械消费金额',
amt_order_sports                      DOUBLE   COMMENT    '运动户外下单金额',
amt_order_emor                        DOUBLE   COMMENT    '凌晨下单金额',
amt_order_mor                         DOUBLE   COMMENT    '早上下单金额',
amt_order_aft                         DOUBLE   COMMENT    '下午下单金额',
amt_order_nig                         DOUBLE   COMMENT    '晚上下单金额',
amt_order_midnig                      DOUBLE   COMMENT    '深夜下单金额',
cnt_order                             DOUBLE   COMMENT    '总订单数',
cnt_sku                               DOUBLE   COMMENT    '总sku数',
cnt_pay_order                         DOUBLE   COMMENT    '先款订单数',
cnt_daofu_order                       DOUBLE   COMMENT    '到付订单数',
cnt_on_line_order                     DOUBLE   COMMENT    '在线支付订单数',
cnt_ziti_order                        DOUBLE   COMMENT    '自提订单数',
cnt_object_ord                        DOUBLE   COMMENT    '实物订单数',
cnt_virtual_ord                       DOUBLE   COMMENT    '虚拟订单数',
cnt_game_order                        DOUBLE   COMMENT    '游戏相关订单数',
cnt_lottery_order                     DOUBLE   COMMENT    '彩票订单定额',
cnt_order_book                        DOUBLE   COMMENT    '图书音像类商品消费订单数',
cnt_order_elec                        DOUBLE   COMMENT    '家用电器消费订单数',
cnt_order_food                        DOUBLE   COMMENT    '生鲜食品类消费订单数',
cnt_order_gift                        DOUBLE   COMMENT    '礼品类商品消费订单数',
cnt_order_med                         DOUBLE   COMMENT    '医药器械消费订单数',
cnt_order_sports                      DOUBLE   COMMENT    '运动户外下单订单数',
cnt_order_emor                        DOUBLE   COMMENT    '凌晨下单订单数',
cnt_order_mor                         DOUBLE   COMMENT    '早上下单订单数',
cnt_order_aft                         DOUBLE   COMMENT    '下午下单订单数',
cnt_order_nig                         DOUBLE   COMMENT    '晚上下单订单数',
cnt_order_midnig                      DOUBLE   COMMENT    '深夜下单订单数',
pct_amt_daofu_vs_ol                   DOUBLE   COMMENT    '到付金额vs在线支付金额',
avg_amt_order                         DOUBLE   COMMENT    '平均订单金额',
avg_amt_pay_order                     DOUBLE   COMMENT    '平均先款订单金额',
avg_amt_on_line_order                 DOUBLE   COMMENT    '平均在线支付订单金额',
avg_amt_object_order                  DOUBLE   COMMENT    '平均实物订单金额'
)COMMENT '建模特征表' PARTITIONED BY (dt STRING COMMENT '操作日期')
ROW FORMAT DELIMITED FIELDS TERMINATED BY '\t' STORED AS TEXTFILE;